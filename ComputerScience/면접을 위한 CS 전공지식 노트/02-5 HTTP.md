# Chapter 2: 네트워크

---

# Section 5: HTTP

HTTP는 기본적으로 **어플리케이션 계층**에 해당하여, 웹 서비스 통신에 사용된다.

HTTP/1.0부터 시작하여 HTTP/3까지 발전한 상황.

---

## HTTP/1.0

**한 연결 당 하나의 요청을 처리**하도록 설계되어있다.

이는 **RTT 증가**를 불러오게 되었다.

### RTT 증가

> #### RTT
> 
> 패킷이 목적지에 도달하고 나서 다시 출발지에 돌아오기까지 걸리는 시간.
> 
> 즉, **패킷 왕복 시간**

서버로부터 어떤 파일을 가져오고자 하는 경우를 생각해볼 때,

- TCP 연결 초기화

- 파일 요청

두 번의 TCP 연결을 개시해야 하고 이 때마다 TCP의 **3-way handshake**를 진행해줘야한다.

이는 RTT를 지나치게 증가시키는 단점을 가진다.

### RTT 증가를 해결하기 위한 방법

**연결할 때마다** RTT가 증가하니, 서버에 부담이 많이 가고 사용자 응답 시간이 길어지는 문제가 생겼다.

이를 해결하기 위해 여러 방법이 사용됐다.

#### 이미지 스플리팅

많은 **이미지**를 다운받는 경우 과부하가 발생하므로, 많은 이미지를 **하나의 이미지로 합쳐** 다운로드 받고 이를 함께 전송된 position 값으로 다시 잘라서 표시하는 방법.

#### 코드 압축

코드를 압축해서 **개행 문자, 빈칸** 등을 없애 코드의 크기를 최소화하는 방법이다.

굉장히 단순한 방법이지만 실제로 코드의 용량이 줄어드는 효과를 가진다.

#### 이미지 Base64 인코딩

이미지 파일을 64진법으로 이루어진 **문자열로 인코딩**하는 방법이다.

> ##### 인코딩
> 
> 정보의 형태나 형식을 다른 형태나 형식으로 변환하는 처리 방식.
> 
> 표준화, 보안, 처리 속도 향상, 저장 공간 절약 등을 위해 사용된다.

서버와의 연결을 열고 이미지에 대해 서버에 HTTP 요청을 할 필요가 없다는 장점이 있지만,

약 37% 정도 용량이 커지는 단점이 있다.

---

## HTTP/1.1

매번 TCP 연결을 하는 것이 아니라, **한 번 TCP 초기화를 한 이후 keep-alive 옵션으로 여러 개의 파일을 송수신할 수 있도록** 바뀌었다.

- 리소스 하나마다 TCP handshake, GET, Response, TCP Teardown을 반복하던 것에서,

- 일단 한 번 TCP handshake가 일어났다면 하나의 요청에 담긴 리소스를 모두 response받아올 때까지 keep-alive를 유지하다가 다 완료된 때 TCP Teardown한다.

HTTP/1.1부터 표준화가 되어, 기본 옵션으로 설정된다.

- 단, 문서 안에 포함된 리소스(이미지, css, script 등)가 다수인 경우 그 개수에 비례하여 대기 시간이 길어지는 단점이 있다.

### HOL Blocking(Head Of Line Blocking)

네트워크에서 **같은 큐**에 있는 패킷이 **선순위 패킷에 의해 처리가 지연**되어 발생하는 성능 저하 현상을 말한다.

HTTP/1.1의 구조 상 이런 경우가 잦다.

### 무거운 헤더 구조

keep-alive를 구현하기 위해 헤더에는 쿠키 등 많은 메타데이터가 들어 있고, 압축이 되지 않아 무거웠다.

---

## HTTP/2

HTTP/2는 기존보다 지연 시간을 줄이고 응답 시간을 더 빠르게 할 수 있다.

멀티플렉싱, 헤더 압축, 서버 푸시, 요청의 우선순위 처리를 지원하는 프로토콜이다.

### 멀티플렉싱

**여러 개의 스트림을 사용하여 송수신**하는 것이다.

특정 스트림의 패킷이 손실되어도, 해당 스트림에만 영향을 미치고 나머지 스트림은 정상 동작할 수 있다.


