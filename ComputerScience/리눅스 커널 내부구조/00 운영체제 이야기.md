# Chapter 00: 운영체제 이야기

---

## 운영체제 동작 사례

운영체제는 일반적으로 **자원 관리자**라고 정의된다.

컴퓨터에 있는 CPU, 메모리, 디스크 등의 자원을 관리하여, 사용자가 컴퓨터를 사용할 수 있도록 지원해준다.

- 사용자가 문서 편집, 인터넷 검색 등의 작업을 수행하면, 이를 위해 필요한 자원을 운영체제가 제공해주는 식.

### 프로그램 작성하고 저장하기

사용자가 test.c라는 이름의 프로그램을 edit라는 편집기를 사용해 작성하고, 이를 컴퓨터에 저장하려 한다.

- 사용자의 저장 요청은 운영체제로 전달되고

- 운영체제는 비휘발성 저장 매체인 **디스크**에 해당 프로그램을 저장한다.
  
  - 저장되는 내용은 일반적으로 파일(file)이라는 객체로 관리된다.

저장 과정을 보다 상세히 파보면,

- 운영체제는 디스크의 일부 공간을 할당 받는다. 
  
  - 일반적으로 4KB 정도를 할당 받으며, 이를 **디스크 블록**이라 한다.
  
  - 여기에 파일 내용을 저장한다.

- 파일의 속성 정보(메타데이터)를 저장하기 위한 공간 또한 디스크에 할당된다.
  
  - 해당 공간은 리눅스에서 **inode**라고 한다.

- 마지막으로, 파일 **이름**인 test.c와 inode 간 연결을 만들고, inode와 **파일의 내용**이 들어있는 **디스크 블록**을 연결한다.

- 결과적으로, **파일 이름만 알면** 그 파일의 내용, 파일의 메타데이터를 찾아갈 수 있다.

### 프로그램 컴파일

프로그램을 컴파일하여, 수행 가능한 **바이너리**를 만들어야 한다.

리눅스 환경에서는 컴파일 후 만들어지는 바이너리의 기본 이름이 a.out이다.

운영체제 입장에서는 바이너리 또한 파일이므로, 앞서의 제시된 과정을 거쳐 inode와 디스크 블록의 형태로 a.out을 관리하게 된다.

- 파일의 크기가 크다면, 디스크 블록을 여러 개 사용하기도 한다.

### 프로그램 수행

바이너리를 수행하면, **태스크**(task)라는 새로운 객체가 생성된다.

기존 a.out이 passive가 아닌 active한 객체로 변화하는 실질을 가진다.

새로운 태스크는, 기존에 존재하던 태스크들과 **경쟁**하며 **CPU**를 사용하려 한다.

이 때 운영체제는 CPU 자원을 모든 태스크들에게 공평하게 나누어주기 위해 노력하게 된다.

- 대표적인 방법은 **라운드 로빈**(round-robin) 방식으로, 모든 태스크들에게 돌아가면서 정해진 시간만큼 CPU를 할당하는 단순한 방식이다.

### 메모리 관리

사실 바이너리 파일이 태스크로 수행되기 위해서는, 파일의 내용(디스크 블록에 있는 내용)이 **메모리에 적재**되어야 한다. CPU는 디스크에 직접 접근할 수 없기 때문.

이를 위해 운영체제는 메모리 자원도 관리해야 한다.

- 새로운 태스크는 우선 메모리의 일부 공간(**페이지 프레임**)을 할당받고, 자신의 바이너리 파일의 **수행 이미지**를 적재한다.

- 각 태스크들은, **세그먼트 테이블**과 **페이지 테이블**을 이용해 자신에게 할당된 페이지 프레임을 관리하게 된다.

> 이후 내용들을 이러한 연속적 과정 속에서 맥락과 함께 파악함으로써, 운영체제의 역할을 전체적으로 이해하는 데 활용할 수 있도록 해야 한다.

---

## 운영체제 동작 비유

> 괜찮은 비유들이 많으니 나중에 필요하면 확인해볼 것
