# 제 1부 도입편

---

# Chapter 01: 시스템과 인프라 기초 지식

---

개발한 애플리케이션을 배포하여 사용자가 이용할 수 있도록 하려면, **시스템 기반**을 구축하고 그 위에 애플리케이션 **실행 환경**을 만들어야 한다.

- 시스템 기반은, **애플리케이션 가동**에 필요한 **하드웨어**나 **OS/미들웨어** 같은 인프라를 말한다.

**Docker**는, 애플리케이션 **실행 환경을 작성 및 관리하기 위한 플랫폼**이라고 볼 수 있다.

---

## 시스템 기반의 기초 지식

과거 폭포수형 모델에서는 **인프라 엔지니어**와 **어플리케이션 엔지니어**가 분리되어 있었다.

- 어플리케이션 실행 환경 구축은 네트워크와 하드웨어에 능통한 인프라 엔지니어가,

- 어플리케시연 캐발은 업무 지식 및 프로그래밍, 테스트 기법을 아는 어플리케이션 엔지니어가.

**클라우드** 등장으로 그 흐름이 크게 바뀌었다.

자사 데이터센터나 기계실 같은 **온프레미스** 환경에서 가동시키던 서버들을, 클라우드 상의 **가상 인스턴스**로 옮기고 DB나 네트워크 등 클라우드 서비스들을 이용함으로써, 실행 환경의 **구축 범위**가 극단적으로 줄어들었다.

- 이에 짧은 사이클로 릴리즈가 반복되는 개발 모델이 대두하였다.

클라우드를 구성하는 대부분의 기술들은 한 대의 물리 호스트 상에서 움직이는 것이 아닌, **분산 환경**에서 가동된다.

이러한 환경에서는 자동화된 툴을 사용하여 **오케스트레이션**을 하게 되고, 인프라 엔지니어가 아닌 어플리케이션 엔지니어도 인프라 구축을 직접 할 수 있게 되었기 때문에 이들도 OS나 네트워크 같은 **인프라 기술의 기초 지식**을 알아야 한다.

### 시스템 기반의 구성 요소

#### 시스템에서 요구되는 사항

크게 두 가지로 나눌 수 있다.

##### 기능 요구사항

**시스템의 기능**으로서 요구되는 사항으로, 시스템이나 소프트웨어에서 무엇을 할 수 있는지 모아놓은 것

##### 비기능 요구사항

**시스템의 성능, 신뢰성, 확장성, 운용성, 보안** 같은 요구사항. 기능 요구사항 이외의 전부.

비기능 요구사항을 충족시키기 위해서는, 프로그래밍 지식뿐만 아니라 **시스템 기반에 관한 지식**이 필요하다.

*그런 관점에서* 시스템 기반을 살펴볼 필요가 있다.

#### 시스템 기반 구성 요소

가장 바닥에 하드웨어/네트워크, 그 위의 OS, 그 위의 미들웨어가 있다.

- 어플리케이션은 그 위에 존재한다.

##### 하드웨어

시스템 기반을 구성하는 **물리적인 요소**. 서버 장비 본체, 스토리지, 전원 장치 등.

##### 네트워크

시스템 이용자가 **원격지에서 엑세스**할 수 있도록 서버들을 연결하기 위한 요구사항.

라우터, 스위치 등 네트워크 장비, 케이블 배선 등도 포함.

무선 LAN 연결 시의 액세스 포인트도 포함

##### OS(운영체제)

하드웨어나 네트워크 장비를 제어하기 위한 **기본 소프트웨어**로 하드웨어의 **리소스나 프로세스를 관리**한다.

- 클라이언트 OS는 사용하를 위한 GUI 기능이나 멀티미디어 기능이 마련되어 있다.
  
  - Windows, macOS 등

- 서버 OS는 시스템을 고속 및 안정적으로 가동시키기 위해 필요한 기능으로 특화되어 있다.
  
  - Unix, Linux 등.

##### 미들웨어

**서버 OS** 상에서 서버가 특정 역할을 다하기 위한 기능을 갖고 있는 소프트웨어.

시스템 기반 설계 시, 어떤 미들웨어를 어떻게 사용할 것인지 선택하는 것이 중요하다.

### 클라우드와 온프레미스

**시스템의 이용 형태**에는 크게 세 가지가 존재한다.

이 중 어떤 형태를 선택해야 하는지는, **시스템 요구사항**에 따라 결정된다.

- 클라우드 이용 시, 업체가 제공하는 서비스를 요구사항에 맞춰 조합하면 그만이므로 **단기간**에 인프라 구축이 가능하고, **초기 투자**도 필요 없다.

#### 온프레미스(on-premises)

기업 시스템에서 지금까지 많이 채택된 형태로, 자사에서 데이터센터를 보유하고 시스템 구축부터 운용까지 전부 수행하는 형태.

- 서버, 네트워크 장비 등 모두 직접 조달하여 인프라 구축하고 운용

- OS나 미들웨어도 직접 구입하고, 라이센스 관리, 버전업까지 직접

초기 시스템 투자에 드는 비용이 크고, 운용 과정에서 드는 비용도 **이용량과 관계없이** 발생한다는 특징이 있다.

#### 퍼블릭 클라우드(public cloud)

인터넷를 통해 **불특정 다수에게 제공**되는 클라우드 서비스.

- AWS, Azure 등이 대표적

- 기업이 사용할 수 있으나, 그 외 일반 **개인 사용자**들도 사용 가능한 서비스다.

자사에 데이터센터를 보유하지 않으므로, 인프라 관련 초기 투자가 필요 없다.

제공할 서비스에 따라, IaaS, PaaS, SaaS 등이 있다. 

- 이 중 **시스템 기반 부분**을 이용하는 서비스를 IaaS라 하는데, IaaS에서는 이용하고 싶은 사양으로 된 가상머신이나 스토리지를 선택하고 **이용량에 따라** 요금을 지불하는 형태다.

시스템 이용량 증가 시 인프라 기반을 손쉽게 증설할 수 있다. (**오토스케일링**)

#### 프라이빗 클라우드(private cloud)

특정 기업 **그룹**에게만 제공되는 클라우드 서비스.

- 그룹 기업 내에서 데이터센터를 공동으로 보유하는 듯한 모습

- 이용자를 한정할 수 있기 때문에 **보안** 확보가 쉽고, 독자적인 기능이나 서비스 추가가 쉽다.

### 클라우드가 적합한 케이스

#### 트래픽의 변동이 많은 시스템

시스템은, **직원용**과 **고객용**으로 나눌 수 있다.

- 직원용은 트래픽 예상이 쉽기 때문에 시스템 기반의 규모나 구성을 검토하기도 쉽다.

- 고객용 시스템은 그러한 예측이 어렵다.

**사이징**은 트래픽 양에 따라 시스템 기반의 서버 사양이나 네트워크 대역을 가늠하는 설계.

사이징이 어려운 시스템은, 트래픽에 따라 시스템을 **단기간에 쉽게 증설**시킬 수 있는 클라우드 시스템으로 구성하는 것이 좋다.

> #### 클라우드의 오토스케일 기능
> 
> **사이징**은 인프라 설계에서 가장 난이도가 높은 공정이다. 업무에 지장을 초래하지 않기 위해 어느 정도의 기반이 필요한 지 정확히 예측해야 하기 때문.
> 
> 인프라에 대한 지식과 경험, 고객 업무에 대한 지식, 어플리케이션에 대한 기술적 이해 등을 모두 갖춰야 한다.
> 
> 하지만 오토스케일 기능을 사용하면, **시스템 부하에 맞춰 동적으로 서버 사양이나 스토리지 용량을 쉽게 증설**시킬 수 있다.
> 
> 심지어 퍼블릭 클라우드를 통해, 해외에도 물리적 서버나 네트워크 구축을 신경쓰지 않고 안정적인 기반 구축이 가능하다.

#### 재해 대책으로 해외에 백업을 구축하고 싶은 시스템

대규모 재해나 지진으로 데이터센터 시스템이 다운되어 업무가 마비되는 상황을 방지하기 위해, 해외에 백업 시스템을 가동시키는 경우가 있다.

이 경우 온프레미스보다 해외 데이터센터를 거점으로 하는 쿨라우드가 적합하다.

> ##### 업무 연속성 계획(BCP)
> 
> 재해 등 리스크 발생 시 *업무 중단이 없거나 중단된 경우에도 목표 복구 기간을 준수하여* 리스크를 최소한으로 하기 위해 준비하는 계획.
> 
> 고객 기업에서 BCP를 두고 있다면, 이에 걸맞는 시스템 기반이 필요하다.

#### 서비스를 빨리 제공하고 싶은 시스템

비즈니스 계획부터, 시스템 릴리즈까지의 시간을 최대한 단축시키기 위해서는 장비 조달이 필요하지 않은 클라우드가 유리하다.

### 온프레미스가 적합한 케이스

#### 높은 가용성이 요구되는 시스템

클라우드 업체가 보장하는 **시스템 가용성**만으로도 불충분한 경우.

소위 **미션 크리티컬 시스템**에서는 클라우드 적용이 불가하다.

#### 기밀성이 높은 데이터를 다루는 시스템

물리적인 저장 장소를 명확히 할 필요가 있는 업무 데이터를 퍼블릭 클라우드에 저장할 수 없다.

#### 특수한 요구사항이 있는 시스템

디바이스나 플랫폼 자체가 특수하여 클라우드 측이 처리해주기 어렵다면, 온프레미스를 활용할 수밖에 없다. 

- 의료 시스템 같이 전용 장비가 존재하는 경우가 대표적.

### 온프레미스? 클라우드?

기존 시스템에 대해 이관을 고려하거나 새로운 시스템을 도입하고자 할 때, 온프레미스와 클라우드 양자 중 어떤 것이 적합한 지 정확히 판단할 수 있는 안목이 필요하다.

경우에 따라서는 온프레미스와 클라우드가 혼재하는, **하이브리드 클라우드**를 이용할 수도 있다.

### 시스템 기반의 구축/운용 흐름

기본 공정은 다음과 같다. 얼핏 어플리케이션 개발 공정과 동일하게 볼 수 있다.

- 시스템화 계획, 요구사항 정의

- 인프라 설계

- 인프라 구축

- **운용**
  
  - 서버 프로세스, 네트워크, 리소스, 배치 Job 모니터링
  
  - OS, 미들웨어 버전 업그레이드
  
  - 시스템 장애 대응
  
  - 데이터 백업 및 정기 유지보수
  
  - 어플리케이션 버전 업그레이드
  
  - 사용자 서포트

**폭포수형 개발**의 경우 공정을 한 차례, 순서대로 이행하고 **애자일 개발**의 경우 개발 단계를 작게 나누어 위 공정을 반복하게 된다.

어플리케이션 개발 공정과 크게 다른 점은 **운용 단계**에 있다.

- 인프라의 경우 릴리스 감시, 보안 업그레이드, 시스템 장애 복구 등 어플리케이션 릴리스의 경우보다 **운용 단계의 업무**가 산적해 있다.

- 유지보수 기간을 최대한 줄이고 안정적으로 가동시키려면, 결국 운용 설계가 중요하다.

- 그리고 유지보수 수고 자체를 줄이기 위해, **자동화**할 수 있는 부분을 최대한 자동화하여 실수를 줄이고 업무를 가시화한다.

**Docker**가 바로, 시스템 구축과 운용에 있어서 많은 작업을 자동화하고, 테스트가 끝난 어플리케이션을 지속적으로 제공할 수 있게 해주는 플랫폼에 해당한다.

---

## 하드웨어와 네트워크 기초 지식

### 서버 장비

클라우드 서비스의 경우, 온프레미스에서 서버 장비의 사양에 해당하는 **인터페이스**의 종류를 잘 선정할 필요가 있다.

#### CPU

프로그램의 설계나 처리 등을 수행하는 전자회로 부품. 작동 주파수가 클수록 높은 연산 능력

CPU 연산회로를 **코어**라고 하고, 코어가 많으면 연산을 동시에 처리할 수 있다.

서버 CPU는 대부분 멀티코어.

CPU와 메모리의 처리 속도 차이를 완충하기 위해 **캐시**를 사용하고, 캐시의 크기도 성능에 영향을 미친다.

GPU는 화상처리를 여러 개의 코어로 동시 및 병렬 처리하는 프로세서인데, 딥러닝 등 대량의 고속 연산이 필요한 경우 이용된다.

CPU와 GPU는 고성능일수록 비용이 올라가기 때문에 서버 장비 구축 시 고려해야 할 부분이다.

#### 메모리

CPU가 직접 엑세스할 수 있는 기억장치.

서버용으로는, 전력 소모가 적고 **오류 처리**가 탑재되어 있는 것을 선정하는 편.

마찬가지로 비용을 고려해야 한다.

#### 스토리지

영구적인 데이터를 저장하는 디바이스로, 보조기억장치라고도 함.

용량, 읽기 쓰기 속도가 시스템 전체 응답 시간에 영향을 준다.

하드디스크나 SSD 등을 이용하고, SAN 스토리지 같이 기업 용도로 이용되는 Fiber Channel 하드디크스도 있다.

데이터 손실을 막기 위해 대부분 **다중화** 구성을 취한다.

#### 그 외: 온프레미스 환경

- 전원 트러블에 의한 순간적 차단을 막기 위한 UPS

- 여러 대의 서버를 관리하기 위한 KVM 스위치

- **서버 랙**: 서버 장치 설치에 사용. 메인터넌스에 쉬운 것을 선택하게 된다.

- 데이터센터, 기계실의 하중 설계, 전기 공사, 공조 설비 등

위와 같은 서버 장비들은 시스템 이용 용도에 따라 하드웨어 제조 업체가 다양한 제품을 출시하고 있기 때문에, 기능이나 예산을 고려하여 도입하게 된다.

#### 그 외: 클라우드 환경

- 하드웨어의 선정은 곧 **가상 머신의 사양 선정**으로 대치된다.

- 기존 서비스에 클라우드를 어떻게 조합할 지에 대해서는 전문적 상담을 요한다.

- 컨설팅부터 운용까지 담당해주는 클라우드 시스템 인테그레이터도 있다.

### 네트워크 주소

네트워크에서는 서버나 클라이언트, 각종 네트워크 장비를 식별하기 위해 **네트워크 주소**를 사용한다.

#### MAC 주소(물리 주소/이더넷 주소)

네트워크 인터페이스 카드, 무선 LAN 칩 등 네트워크 부품에 **물리적으로 할당되는 48비트 주소**다.

- 앞 24비트는 부품 제조업체 식별번호.

- 16진수로 표기하고, 앞에서 2바이트씩 구분된다.

- OSI 모델 중 2계층인, **데이터 링크 계층**에서 사용한다.

#### IP 주소

인터넷이나 인트라넷 같이 **네트워크에 연결된** 컴퓨터나 네트워크 장비에 할당되는 식별 번호.

- IPv4의 경우 8비트씩 4개로 구분된 32비트 주소인데, 하나의 네트워크에 2^32대까지만 연결이 가능해서 IP 주소 고갈이 우려되는 사황.

- 따라서 최근 프라이빗 IP와 퍼블릭 IP를 구분하여, 
  
  - 업무에 사용되는 내부 네트워크에서는 임의의 주소를 할당하는 프라이빗 주소를
  
  - 외부 인터넷과의 경계에서는 **NAT**이라는 장비를 통해 변환된 퍼블릭 주소를 사용하는 방식을 흔히 사용한다.
  
  - IPv6에서는 아예 128비트짜리 주소를 할당한다.

### OSI 참조 모델과 통신 프로토콜

통신을 서로 이해하기 위해서는 적절한 **약속**이 필요하다.

**통신 프로토콜**이, 서로 어떤 약속으로 통신을 할지 정한 규약에 해당한다.

시스템은 웹, 메일 송수신, 파일 전송, Secure Shell 등 통신을 사용하는데, 각각의 프로토콜이 정해져 있다.

OSI 참조 모델은, **컴퓨터의 통신 기능을 계층 구조로 나눈** 개념 모델이다.

#### 응용 계층 (레이어 7)

웹의 HTTP나 메일 전송을 하는 SMTP 같은, **어플리케이션에 특화된** 프로토콜을 규정한다.

#### 표현 계층 (레이어 6)

데이터의 저장 형식이나 압축, 문자 인코딩 같은 **데이터의 표현 형식**을 규정한다.

#### 세션 계층 (레이어 5)

커넥션 확립 타이밍이나 데이터 전송 타이밍을 규정한다.

어플리케이션 간 request와 response로 구성된다.

#### 전송 계층 (레이어 4)

데이터 전송을 제어하는 계층이다. 전송 오류를 검출하고, 재전송을 규정한다.

대표적인 프로토콜은 **TCP**와 **UTP**.

- 이 정도 선에서 데이터가 통신 상대의 노드로 확실하게 보내진다.

#### 네트워크 계층 (레이어 3)

**서로 다른 네트워크 간**에 통신을 하기 위한 규정이다.

서로 다른 네트워크에 데이터 패킷을 전송하는 것을 **라우팅**이라 한다.

IP주소를 바탕으로 네트워크 계층에서 작동하는 통신 장비로는 **라우터**와 **L3 스위치**가 있고, 이러한 장비들은 패킷을 어디로 전송할지 정보를 담는 **라우팅 테이블**을 관리하고 있다.

#### 데이터 링크 계층 (레이어 2)

**동일한 네트워크 안**에 있는 노드 간 통신을 규정한다.

MAC 주소로 데이터를 전송하고, 주요 네트워크 장비로는 **L2 스위치**가 있다.

- L2 스위치는 통신할 노드가 어떤 포트에 연결되어 있는지 MAC 주소를 사용해 판단하고 패킷을 전송한다.

#### 물리 계층 (레이어 1)

통신 장비의 물리적 및 전기적 특성을 규정한다.

데이터를 어떻게 전기적으로 할당할 것인지, 케이블이나 커넥터의 모양 등.

### 방화벽

시스템 가동 시 **보안**은 매우 중요한 파트이다.

그리고 보안에 가장 효과적인 방법 중 하나가, **외부와의 불필요한 통신을 차단하는 것**이다.

- 방화벽은 내부와 외부 네트워크 간 통신을 제어하여 내부 네트워크의 안전을 유지하기 위한 기술이다.

#### 패킷 필터형

통과하는 패킷을 포트번호, IP 주소를 바탕으로 필터링하는 방법.

패킷 필터링의 룰을 **ACL**(엑세스 제어 리스트)라고 한다.

#### 어플리케이션 게이트웨이형

어플리케이션 프로토콜 레벨에서 외부와의 통신을 대체 제어하는 방식

일반적으로 **프록시 서버**라고 부른다.

### 라우터/L3 스위치

**라우터**는, 2개 이상의 서로 다른 네트워크 간을 중계하기 위한 통신 장비.

- OSI 3계층인 **네트워크 계층에서 작동**

- 어떤 루트로 데이터를 전송할지 판단하기 위해 **경로 선택 기능**을 가짐.
  
  - 경유 대상이 되는 루트에는 **라우팅 테이블** 바탕으로 정해지는 **정적 경로**와 라우팅 프로토콜에서 설정되는 **동적 경로**가 있다.

**L3 스위치**는 라우터와 거의 같은 기능을 가지지만, **라우팅을 하드웨어로 처리**하고 있어서 보다 빠르다는 특징이 있다.

- 연결할 수 있는 **이더넷 포트** 수가 많다.

---

## OS(Linux) 기초 지식

하드웨어나 네트워크를 제어하는 것이 OS의 역할.

Docker는 Linux의 기능을 적극 사용하는 기술이다.

### Linux

1991년 개발된 **Unix 호환 서버 OS**이다. 보안에 뛰어나고 안정성이 좋아 널리 이용 중에 있다.

**오픈소스**를 기본으로 하고 있기 때문에, 누구나 자유롭게 수정 및 재배포가 가능하고 이를 바탕으로 빠르게 성장했다.

#### Linux 커널

Linux에서 **커널**(kernel)은 OS의 코어가 되는 부분을 말한다.

메모리 관리, 파일 시스템, 프로세스 관리, 디바이스 제어 등 OS로서 하드웨어와 어플리케이션 소프트웨어를 제어하기 우한 **기본 기능**을 가진 **소프트웨어**에 해당한다.

#### Linux 배포판

일반적으로 Linux는 배포판이라는 형태로 패키지화되어 배포된다.

배포판에는 Linux 커널에 더해, 각종 커맨드와 라이브러리, 어플리케이션이 포홤되어 사용을 편리하게 해준다.

Linux 커널 이외의 부분은 **사용자 공간**(userland)이라 한다.

- 사용자 공간의 어플리케이션은 외부 디바이스에 직접 엑세스가 불가하고, Linux 커널을 거쳐야 한다.

### Linux 커널

하드웨어 제어 등 OS의 핵심 기능을 담은 Linux 커널의 주요 기능은 다음과 같다.

#### 디바이스 관리

커널은 **디바이스 드라이버**라는 소프트웨어를 이용해 CPU, 메모리, 디스크, 입출력 장치 등 하드웨어를 제어한다.

#### 프로세스 관리

Linux에서 명령을 실행하면, 해당 프로그램 파일에 적힌 내용을 읽어 메모리에 전개함으로써 프로그램이 실행되고, 실행된 프로그램을 **프로세스**라 한다.

OS 작동 시 일반적으로 여러 개의 프로세스가 **동시에 실행**되는데, 

- 커널은 프로세스에 **PID**라는 식별자를 붙여 관리하고

- 프로세스 실행에 필요한 CPU를 효율적으로 할당한다.

#### 메모리 관리

커널은 프로그램 및 프로그램 내의 데이터가 물리 메모리에 전개될 때 이를 **효율적으로 할당**하는 역할을 가진다.

실행이 끝난 프로세스가 사용하던 메모리 영역을 해제하는 것 또한 커널의 역할이다.

메모리의 **용량 제한**을 극복하기 위해, 보조기억장치에 **스왑**이라고 하는 **가상 메모리** 영역을 만들어두는데, 커널은 메모리에 전개된 데이터들을 **이용 빈도**를 기준으로 *스왑인* 또는 *스왑아웃*하는 일을 한다.

#### 쉘(Shell)

커널을 조작하기 위해서는, 사용자가 내린 명령을 **커맨드**로 받아 **커널에 전달**하는 쉘이 필요하다.

- 쉘을 통해, 어플리케이션 실행/정지, 환경변수 관리, 명령 이력 관리, 명령 실행 결과 표시 및 파일 출력이 가능하다.

쉘에서 실행하고자 하는 명령을 모아 텍스트로 기술한 것을 **쉘 스크립트**(.sh)라고 한다.

### Linux 파일 시스템

파일 시스템은, Linux에서 하드디스크나 USB 메모리, CD 등 데이터에 **엑세스하기 위한 장치**이다.

커널은 **VFS**(가상 파일 시스템)이라는 장치를 사용해, 데이터를 이용하는 어플리케이션이 데이터의 **물리적 위치**와 관계없이 **투과적으로 엑세스**할 수 있는 기능을 제공하고 있다.

- 어플리케이션이 이용할 데이터가 하드디스크에 있든, USB 메모리에 있든, 네트워크 너머에 있든 **같은 방식**으로 접근할 수 있다는 뜻.

- VFS에서는 각 디바이스를 **파일**로 취급하는 특징을 가진다.
  
  - 서버는 /mount, 하드디스크는 /bin, CD는 /cdrom 으로 접근하는 식

### Linux 디렉토리 구성

Linux는 커널을 비롯해 각종 커맨드와 설정 파일들이 디렉토리에 배치된다.

Linux의 디렉토리는 FHS라는 규격에 의해 표준화되어 있다.

#### 주요 디렉토리

##### /bin

ls나 cp 같이 **기본 커맨드**를 저장하는 디렉토리.

##### /boot

커널 등 **OS 시작**에 필요한 파일을 배치하는 디렉토리.

- 그 커널도 알고보면 `vmlinuz`라는 파일이다.

##### /dev

하드디스크, 키보드, 디바이스 파일을 저장하는 디렉토리.

##### /etc

OS나 어플리케이션이 작동하는 데 필요한 **설정 파일**이 저장된 디렉토리.

##### /home

**일반 사용자**의 홈 디렉토리. 시스템 이용자가 자유롭게 사용 가능하다.

##### /proc

커널이나 프로세스 관련 정보가 저장된 디렉토리

##### /sbin

시스템 관리용 마운트가 저장된 디렉토리.

##### /tmp

일시적으로 사용하는 파일 등을 저장하는 임시 디렉토리.

- 하드디스크에 있는 파일이 아니고, **tmpfs 파일 시스템**을 이용해 **메모리상에 전개**되어 있기 때문에 서버 재시작 시 사라진다.

##### /usr

각종 프로그램이나 커널 소스가 저장되는 디렉토리

- /usr/local은 시스템 관리자가 **어플리케이션을 설치하는 장소**.

##### /var

시스템 가동에 의해 변화하는 파일을 놓아두는 디렉토리.

### Linux 보안 기능

#### 계정에 대한 권한 설정

사용자 계정에 권한을 설정할 수 있다.

권한은 시스템 전체를 관리할 수 있는 **특권 사용자 root**와 일반 사용자로 나뉜다.

- root는 시스템 종료, 파일 시스템 마운트/언마운트, 어플리케이션 설치 및 실행 권한을 가진다.

미들웨어 같은 데몬 기동을 위한 **시스템 계정**도 작성할 수 있다.

- 시스템 계정은 **특정 프로세스**를 작동시키기 위한 계쩡

계정에 그룹을 설정하고, 파일이나 디렉토리에 계정 및 그룹별 **엑세스 권한**을 세세하게 설정할 수 있다.

- 엑세스 권한을 **퍼미션**(permission)이라 부른다.

- **읽기, 쓰기, 실행**에 대해 권한을 설정할 수 있다.

#### 네트워크 필터링을 사용한 보안 기능

기본적으로 네트워크를 경유해 **멀티유저**가 이용하는 것을 전제로 하였기 때문에, 네트워크 관련 기능이 풍부하다.

- 그 중 `iptables`는 Linux 내장 **패킷 필터링** 및 **네트워크 주소 변환**(NAT) 기능을 *설정*하는 기능.

#### SELinux(Security-Enhanced Linux)

SELinux는 미국 국가안전보장국이 Linux 커널에 **강제 엑세스 제어 기능을 추가**한 것.

기본적으로 Linux에서 디렉토리와 파일 엑세스는 퍼미션에 기초하는데, root 사용자의 경우 퍼미션 설정값에 관계없이 **모든** 엑세스가 열려있기 때문에 다소 위험요소가 존재한다.

SELinux는, 두 가지를 추가하여 보안을 강화했다.

- 보안 대상에 따라 HTTP/FTP 같이 **프로세스마다** 액세스 제한을 거는 **Type Enforment**(TE)

- root를 포함한 모든 사용자에게 제어를 거는 **롤베이스 엑세스 제어**(RBAC)
  
  - root에게 권한이 집중됨을 막아 시스템 보안을 높임.

---

## 미들웨어 기초 지식

미들웨어는, **OS와 어플리케이션 사이**에 들어가는 소프트웨어를 말한다.

- OS 기능을 확장한 것, 어플리케이션들의 공통 기능을 제공하는 것, 각종 서버 기능을 제공하는 것 등 다양한 종류가 이용되고 있다.

### 웹 서버 / 웹 어플리케이션 서버

웹 서버는, 클라이언트의 브라우저가 보낸 **HTTP 요청**을 받아 웹 컨텐츠를 응답으로 반환하거나 다른 서버사이드 프로그램을 호출하는 기능을 가진 서버다.

#### 대표적인 웹 서버

##### Apache HTTP Server

오픈소스 웹 서버. 규모를 가리지 않고 폭넓게 이용되는, 역사와 전통을 자랑하는 웹 서버

##### Internet Information Services

MS가 제공하는 웹 서버. Windows Server OS 제품에 들어 있다.

##### Nginx

오픈소스 웹 서버. 소비 메모리가 적고, 리버스 프록시 기능과 로드밸런서 기능도 갖고 있다.

### 데이터베이스 서버

시스템이 생성하는 다양한 데이터를 관리하기 위한 미들웨어.

CRUD 같은 기본 기능 외에 **트랜잭션 처리** 등도 포함하는 점에서, **DBMS**(데이터베이스 관리 시스템)이라고도 부른다.

#### 대표적인 데이터베이스 서버

##### MySQL

Oracle이 제공하는 오픈소스 RDBMS. 가장 많이 보급되어 있다.

##### PostgreSQL

오픈소스 RDBMS로, MySQL과 나란히 업무 시스템에 많이 사용된다.

##### Oracle Database

Oracle이 개발한 상용 RDBMS. 업무 시스템에 가장 많이 사용된다.

Unix, Linux 등 서버 OS 뿐 아니라 메인 프레임, 클라이언트 PC까지 폭넓은 플랫폼을 지원한다.

##### NoSQL

NoSQL은 RDBMS와는 다른 새로운 방식을 **통틀어 일컫는** 말이다.

**병렬분산처리**와 **유연한 스키마 설정** 등을 특징으로 한다.

주요 방식으로는 **KVS**(Key-Value 스토어)나 **도큐먼트 지향 데이터베이스**, **XML 데이터베이스** 등이 있다.

- **대량의 데이터** 축적이나 **병렬처리**에 뛰어나, **다수의 사용자 엑세스**를 처리해야 하는 온라인 시스템에 널리 이용되고 있다.

##### Redis

메인 메모리 상에 KVS를 구축할 수 있는 OSS의 NoSQL.

어플리케이션에서 데이터의 저장과 읽기를 할 수 있어 매우 빠르다.

##### MongoDB

도큐먼트라는 구조적 데이터를 컬렉션으로 관리하는 OSS의 NoSQL.

도큐먼트는 복잡한 **계층 구조**를 가질 수 있기 때문에, 쿼리나 인덱스 생성도 가능하다.

온라인 게임이나 로그 분석 등에 이용

### 시스템 감시 툴

시스템의 감시 대상인 서버나 장비의 상태를 감시하여, 미리 설정된 경계 값을 초과한 경우 정해진 액션을 실행하는 툴.

시스템 릴리즈 이후 인프라 운용 관리 단계에서 사용된다.

#### 대표적인 시스템 감시 툴

##### Zabbix

Zabbix SIA가 개발한, 다양한 서버의 상태를 감시 및 추적하기 위한 오픈소스 소프트웨어.

##### Datadog

Datadog가 개발한, 서버 통합감시용 SaaS.

통합감시 서버를 따로 도입할 필요 없이 **웹 브라우저에서** 통합감시가 가능하다.

하이브리드 클라우드 환경도 손쉽게 적용 가능하다.

##### Mackerel

Hatena가 개발한 서버 통합감시용 SaaS.

Datadog와 같은 특징을 가진다. 클라우드 상 서버에 친화성이 높다.

---

## 인프라 구성 관리 기초 지식

### 인프라 구성 관리

인프라를 구성하는 하드웨어, 네트워크, OS, 미들웨어, 어플리케이션의 구성 정보를 관리하고 적절한 상태로 유지하는 작업.

- 온프레미스의 경우 일단 구축된 장비를 기반으로 버전업, 퍼포먼스 튜닝, 구성 요소 변경 등의 운용 관리가 이루어지기 때문에 **인프라 환경 규모**가 클수록 인프라 구성 관리의 **부하**가 커진다.

- 클라우드의 경우 **가상 환경** 기반이기 때문에 **물리적인 제약**이 없다.
  
  - 한 번 구축한 인프라에 문제가 있거나 하면, 변경보다 **파기 후 새로 구축**하는 전략을 취하게 된다.
  
  - 변경 이력 관리 없이, **현재 작동 중인 인프라 상태**에만 집중하면서 관리하면 된다.
  
  - 이러한 인프라를 **Immutable Infrastructure**라고 한다.

### 코드를 사용한 구성 관리

온프레미스와 클라우드 모두 시스템 기반 구축에 있어서 **셋업** 절차는 반드시 필요하다.

대부분의 셋업 작업은 오랜 시간이 걸리는 **단순 반복 작업**이기 때문에, 수작업으로 돌입하면 실수가 쉽게 발생한다.

- 이러한 **인프라 구성 관리** 작업은 초기 인프라 구축 공정, 시스템 가동 이후 OS나 미들웨어 버전업, 보안 패치 적용 등 전반에 영향을 주기 때문에 실수가 용납되지 않는다.

- 최악의 경우 중대한 시스템 장애나 정보 유출 등 보안 인시던트를 초래할 수도 있다.

따라서, 과거 인프라 구축은 대부분 **인프라 방식 설계서**를 토대로 장비의 **파라미터 시트**를 두고 이를 바탕으로 셋업이 이루어졌다.

이후에는 여기서 발전되어 **코드**를 기반으로 **자동으로 설정**해주는 장치를 개발해, 그 누가 실행해도 똑같은 인프라 환경을 구축할 수 있도록 하고 있다.

코드 사용 시 좋은 점으로, **인프라 구성 정보를 코드로 관리**할 시 마치 어플리케이션 소스코드처럼 버전 관리 소프트웨어(Git 등)로 **인프라 구성 정보의 변경 이력**을 일원화하여 관리할 수 있다는 점이다.

- 아무 이력 없이 구성을 변경시켜버리면, 인프라 전체가 **블랙박스화**되는 결과를 초래할 수 있다.

- 구성 변경 시 커밋 메시지를 붙임으로써 이력을 공유할 수 있고, 구성을 가시화할 수 있어 인적 실수 배제가 가능하다.

- 이렇게 인프라 구성을 코드로 관리하는 것을 **Infrastructure as Code**라고 한다.

Docker에서 `Dockerfile`을 두는 것이, 인프라 구성 정보를 코드로 관리하는 모습이라고 보면 된다.

### 대표적인 인프라 구성 관리 툴

기능에 따라 여러 툴들이 존재하고 있다.

#### OS의 시작을 자동화하는 툴

서버 OS 설치 및 가상화 툴 설치, 설정하는 작업을 자동화하는 툴이다.

- RedHat 계열의 KickStart, 로컬 PC에서 가상 환경을 만드는 Vagrant 등

#### OS나 미들웨어 설정을 자동화하는 툴

DB, 웹 서버 등 미들웨어 설치나 버전 관리, OS/미들웨어 설정 파일이나 OS 방화벽 기능 설정 등을 자동화하는 툴이다.

- Ruby로 작성된 Chef, Python으로 작성된 Ansible, Puppet 등

#### 여러 서버의 관리를 자동화하는 툴

보통 대규모 시스템은 서버를 여러 대 두는데, 이러한 분산 환경의 서버들을 관리하는 툴이 있다.

그 중 **Kubernetes**는, **컨테이너 오케스트레이션**에서 사실상 **표준**의 위치를 차지하고 있다.

- Kubernetes는 **컨테이너 가상 환경**에서 여러 컨테이너를 **통합 관리**하는 툴이다.

### Continuous Integration / Continuous Delievery

#### CI(Continuous Integration)

어플리케이션 코드를 추가 및 수정할 때마다, **테스트를 실행**하고 **확실하게 작동하는 코드를 유지**하는 방법을 뜻한다.

소프트웨어 품질 향상을 목적으로 고안된 **개발 프로세스**에 해당한다.

- 코드를 레포지토리에 커밋했을 때, **빌드** 및 **테스트 실행**하고 **결과 보고서 작성**까지 자동으로 해주는 것.

- 특정 모듈이 제대로 작동하는지 확인하는 테스트를 **단위 테스트**라고 하는데, 소프트웨어가 클수록 필요한 단위 테스트가 늘어나므로 **Jenkins** 같은 툴을 이용해 테스트를 자동화한다.

단위 테스트가 성공한 모듈이어도 OS 설정, 네트워크, DB, 계정 권한 등 **인프라 환경**의 차이로 인해 어플리케이션 동작에 문제가 발생할 수 있기 때문에, **인프라 구성에 관한 부분을 코드로 관리**하는 것이 **CI 환경**에서 더욱 중요해진다.

#### CD(Continuous Delievery)

기존 폭포형 개발에서는 요건 정의부터 서비스 릴리즈까지 텀이 너무 길어서, 막상 릴리즈 시점에서는 사용자의 니즈를 충족시키지 못하는 경우가 잦았다.

그래서 기능을 전부 다 만들고 배포하는 게 아닌, **기능을 추가할 때마다 배포**하고 **이용자의 피드백을 받아서 그 다음 개발 방향을 결정**하는 **애자일형 개발 방법론**이 대두되었다.

- 단계 자체는 동일하지만, **사이클이 매우 짧아진 것**.

- 사이클이 짧아져서 자주 반복되는 배포를 자동화하는 툴들도 다수 생겨났다.

- 이를 통해 이용자가 최종 어플리케이션에 만족할 확률을 크게 높일 수 있다.

이 때 제품 환경에서의 어플리케이션 **버전업** 작업이 꾸준히 일어나야 하는데 상당히 신경써야 할 이벤트이다.

- 아무리 테스트를 거쳤어도 테스트 환경에 도입하는 절차와 **제품 환경**에 도입하는 절차는 분리되어 있기 때문.

- **인프라 환경 코드도 포함한 테스트를 마친 어플리케이션**을 제품 환경에 전개함으로써 안전한 버전업을 가능하게 한다.

클라우드 환경에서는 **블루 그린 디플로이먼트**라는 방법을 사용하기도 한다.

- 현재 작동하는 시스템인 *블루*와 버전업 시스템 *그린*을 **동시에 작동시킨 상태**에서 시스템을 전환하여, 혹시 문제가 있으면 블루로 바로 되돌리는 방식이다.

> #### Cloud Native Computing Foundation
> 
> 클라우드 네이티브 컴퓨팅을 추진하는 조직. Linux Foundation에서 발ㄹ족.
> 
> Kubernetes, Fluentnd 등 16개의 프로젝트를 관리 중.
> 
> 프로젝트를 Inception, Incubating, Graduated 3개의 성숙도 단계로 분류하고 있다.


