# 제 1부 도입편

---

# Chapter 01: 시스템과 인프라 기초 지식

---

개발한 애플리케이션을 배포하여 사용자가 이용할 수 있도록 하려면, **시스템 기반**을 구축하고 그 위에 애플리케이션 **실행 환경**을 만들어야 한다.

- 시스템 기반은, **애플리케이션 가동**에 필요한 **하드웨어**나 **OS/미들웨어** 같은 인프라를 말한다.

**Docker**는, 애플리케이션 **실행 환경을 작성 및 관리하기 위한 플랫폼**이라고 볼 수 있다.

---

## 시스템 기반의 기초 지식

과거 폭포수형 모델에서는 **인프라 엔지니어**와 **어플리케이션 엔지니어**가 분리되어 있었다.

- 어플리케이션 실행 환경 구축은 네트워크와 하드웨어에 능통한 인프라 엔지니어가,

- 어플리케시연 캐발은 업무 지식 및 프로그래밍, 테스트 기법을 아는 어플리케이션 엔지니어가.

**클라우드** 등장으로 그 흐름이 크게 바뀌었다.

자사 데이터센터나 기계실 같은 **온프레미스** 환경에서 가동시키던 서버들을, 클라우드 상의 **가상 인스턴스**로 옮기고 DB나 네트워크 등 클라우드 서비스들을 이용함으로써, 실행 환경의 **구축 범위**가 극단적으로 줄어들었다.

- 이에 짧은 사이클로 릴리즈가 반복되는 개발 모델이 대두하였다.

클라우드를 구성하는 대부분의 기술들은 한 대의 물리 호스트 상에서 움직이는 것이 아닌, **분산 환경**에서 가동된다.

이러한 환경에서는 자동화된 툴을 사용하여 **오케스트레이션**을 하게 되고, 인프라 엔지니어가 아닌 어플리케이션 엔지니어도 인프라 구축을 직접 할 수 있게 되었기 때문에 이들도 OS나 네트워크 같은 **인프라 기술의 기초 지식**을 알아야 한다.

### 시스템 기반의 구성 요소

#### 시스템에서 요구되는 사항

크게 두 가지로 나눌 수 있다.

##### 기능 요구사항

**시스템의 기능**으로서 요구되는 사항으로, 시스템이나 소프트웨어에서 무엇을 할 수 있는지 모아놓은 것

##### 비기능 요구사항

**시스템의 성능, 신뢰성, 확장성, 운용성, 보안** 같은 요구사항. 기능 요구사항 이외의 전부.

비기능 요구사항을 충족시키기 위해서는, 프로그래밍 지식뿐만 아니라 **시스템 기반에 관한 지식**이 필요하다.

*그런 관점에서* 시스템 기반을 살펴볼 필요가 있다.

#### 시스템 기반 구성 요소

가장 바닥에 하드웨어/네트워크, 그 위의 OS, 그 위의 미들웨어가 있다.

- 어플리케이션은 그 위에 존재한다.

##### 하드웨어

시스템 기반을 구성하는 **물리적인 요소**. 서버 장비 본체, 스토리지, 전원 장치 등.

##### 네트워크

시스템 이용자가 **원격지에서 엑세스**할 수 있도록 서버들을 연결하기 위한 요구사항.

라우터, 스위치 등 네트워크 장비, 케이블 배선 등도 포함.

무선 LAN 연결 시의 액세스 포인트도 포함

##### OS(운영체제)

하드웨어나 네트워크 장비를 제어하기 위한 **기본 소프트웨어**로 하드웨어의 **리소스나 프로세스를 관리**한다.

- 클라이언트 OS는 사용하를 위한 GUI 기능이나 멀티미디어 기능이 마련되어 있다.
  
  - Windows, macOS 등

- 서버 OS는 시스템을 고속 및 안정적으로 가동시키기 위해 필요한 기능으로 특화되어 있다.
  
  - Unix, Linux 등.

##### 미들웨어

**서버 OS** 상에서 서버가 특정 역할을 다하기 위한 기능을 갖고 있는 소프트웨어.

시스템 기반 설계 시, 어떤 미들웨어를 어떻게 사용할 것인지 선택하는 것이 중요하다.

### 클라우드와 온프레미스

**시스템의 이용 형태**에는 크게 세 가지가 존재한다.

이 중 어떤 형태를 선택해야 하는지는, **시스템 요구사항**에 따라 결정된다.

- 클라우드 이용 시, 업체가 제공하는 서비스를 요구사항에 맞춰 조합하면 그만이므로 **단기간**에 인프라 구축이 가능하고, **초기 투자**도 필요 없다.

#### 온프레미스(on-premises)

기업 시스템에서 지금까지 많이 채택된 형태로, 자사에서 데이터센터를 보유하고 시스템 구축부터 운용까지 전부 수행하는 형태.

- 서버, 네트워크 장비 등 모두 직접 조달하여 인프라 구축하고 운용

- OS나 미들웨어도 직접 구입하고, 라이센스 관리, 버전업까지 직접

초기 시스템 투자에 드는 비용이 크고, 운용 과정에서 드는 비용도 **이용량과 관계없이** 발생한다는 특징이 있다.

#### 퍼블릭 클라우드(public cloud)

인터넷를 통해 **불특정 다수에게 제공**되는 클라우드 서비스.

- AWS, Azure 등이 대표적

- 기업이 사용할 수 있으나, 그 외 일반 **개인 사용자**들도 사용 가능한 서비스다.

자사에 데이터센터를 보유하지 않으므로, 인프라 관련 초기 투자가 필요 없다.

제공할 서비스에 따라, IaaS, PaaS, SaaS 등이 있다. 

- 이 중 **시스템 기반 부분**을 이용하는 서비스를 IaaS라 하는데, IaaS에서는 이용하고 싶은 사양으로 된 가상머신이나 스토리지를 선택하고 **이용량에 따라** 요금을 지불하는 형태다.

시스템 이용량 증가 시 인프라 기반을 손쉽게 증설할 수 있다. (**오토스케일링**)

#### 프라이빗 클라우드(private cloud)

특정 기업 **그룹**에게만 제공되는 클라우드 서비스.

- 그룹 기업 내에서 데이터센터를 공동으로 보유하는 듯한 모습

- 이용자를 한정할 수 있기 때문에 **보안** 확보가 쉽고, 독자적인 기능이나 서비스 추가가 쉽다.

### 클라우드가 적합한 케이스

#### 트래픽의 변동이 많은 시스템

시스템은, **직원용**과 **고객용**으로 나눌 수 있다.

- 직원용은 트래픽 예상이 쉽기 때문에 시스템 기반의 규모나 구성을 검토하기도 쉽다.

- 고객용 시스템은 그러한 예측이 어렵다.

**사이징**은 트래픽 양에 따라 시스템 기반의 서버 사양이나 네트워크 대역을 가늠하는 설계.

사이징이 어려운 시스템은, 트래픽에 따라 시스템을 **단기간에 쉽게 증설**시킬 수 있는 클라우드 시스템으로 구성하는 것이 좋다.

> #### 클라우드의 오토스케일 기능
> 
> **사이징**은 인프라 설계에서 가장 난이도가 높은 공정이다. 업무에 지장을 초래하지 않기 위해 어느 정도의 기반이 필요한 지 정확히 예측해야 하기 때문.
> 
> 인프라에 대한 지식과 경험, 고객 업무에 대한 지식, 어플리케이션에 대한 기술적 이해 등을 모두 갖춰야 한다.
> 
> 하지만 오토스케일 기능을 사용하면, **시스템 부하에 맞춰 동적으로 서버 사양이나 스토리지 용량을 쉽게 증설**시킬 수 있다.
> 
> 심지어 퍼블릭 클라우드를 통해, 해외에도 물리적 서버나 네트워크 구축을 신경쓰지 않고 안정적인 기반 구축이 가능하다.

#### 재해 대책으로 해외에 백업을 구축하고 싶은 시스템

대규모 재해나 지진으로 데이터센터 시스템이 다운되어 업무가 마비되는 상황을 방지하기 위해, 해외에 백업 시스템을 가동시키는 경우가 있다.

이 경우 온프레미스보다 해외 데이터센터를 거점으로 하는 쿨라우드가 적합하다.

> ##### 업무 연속성 계획(BCP)
> 
> 재해 등 리스크 발생 시 *업무 중단이 없거나 중단된 경우에도 목표 복구 기간을 준수하여* 리스크를 최소한으로 하기 위해 준비하는 계획.
> 
> 고객 기업에서 BCP를 두고 있다면, 이에 걸맞는 시스템 기반이 필요하다.

#### 서비스를 빨리 제공하고 싶은 시스템

비즈니스 계획부터, 시스템 릴리즈까지의 시간을 최대한 단축시키기 위해서는 장비 조달이 필요하지 않은 클라우드가 유리하다.

### 온프레미스가 적합한 케이스

#### 높은 가용성이 요구되는 시스템

클라우드 업체가 보장하는 **시스템 가용성**만으로도 불충분한 경우.

소위 **미션 크리티컬 시스템**에서는 클라우드 적용이 불가하다.

#### 기밀성이 높은 데이터를 다루는 시스템

물리적인 저장 장소를 명확히 할 필요가 있는 업무 데이터를 퍼블릭 클라우드에 저장할 수 없다.

#### 특수한 요구사항이 있는 시스템

디바이스나 플랫폼 자체가 특수하여 클라우드 측이 처리해주기 어렵다면, 온프레미스를 활용할 수밖에 없다. 

- 의료 시스템 같이 전용 장비가 존재하는 경우가 대표적.

### 온프레미스? 클라우드?

기존 시스템에 대해 이관을 고려하거나 새로운 시스템을 도입하고자 할 때, 온프레미스와 클라우드 양자 중 어떤 것이 적합한 지 정확히 판단할 수 있는 안목이 필요하다.

경우에 따라서는 온프레미스와 클라우드가 혼재하는, **하이브리드 클라우드**를 이용할 수도 있다.

### 시스템 기반의 구축/운용 흐름

기본 공정은 다음과 같다. 얼핏 어플리케이션 개발 공정과 동일하게 볼 수 있다.

- 시스템화 계획, 요구사항 정의

- 인프라 설계

- 인프라 구축

- **운용**
  
  - 서버 프로세스, 네트워크, 리소스, 배치 Job 모니터링
  
  - OS, 미들웨어 버전 업그레이드
  
  - 시스템 장애 대응
  
  - 데이터 백업 및 정기 유지보수
  
  - 어플리케이션 버전 업그레이드
  
  - 사용자 서포트

**폭포수형 개발**의 경우 공정을 한 차례, 순서대로 이행하고 **애자일 개발**의 경우 개발 단계를 작게 나누어 위 공정을 반복하게 된다.

어플리케이션 개발 공정과 크게 다른 점은 **운용 단계**에 있다.

- 인프라의 경우 릴리스 감시, 보안 업그레이드, 시스템 장애 복구 등 어플리케이션 릴리스의 경우보다 **운용 단계의 업무**가 산적해 있다.

- 유지보수 기간을 최대한 줄이고 안정적으로 가동시키려면, 결국 운용 설계가 중요하다.

- 그리고 유지보수 수고 자체를 줄이기 위해, **자동화**할 수 있는 부분을 최대한 자동화하여 실수를 줄이고 업무를 가시화한다.

**Docker**가 바로, 시스템 구축과 운용에 있어서 많은 작업을 자동화하고, 테스트가 끝난 어플리케이션을 지속적으로 제공할 수 있게 해주는 플랫폼에 해당한다.

---

## 하드웨어와 네트워크 기초 지식

### 서버 장비

클라우드 서비스의 경우, 온프레미스에서 서버 장비의 사양에 해당하는 **인터페이스**의 종류를 잘 선정할 필요가 있다.

#### CPU

프로그램의 설계나 처리 등을 수행하는 전자회로 부품. 작동 주파수가 클수록 높은 연산 능력

CPU 연산회로를 **코어**라고 하고, 코어가 많으면 연산을 동시에 처리할 수 있다.

서버 CPU는 대부분 멀티코어.

CPU와 메모리의 처리 속도 차이를 완충하기 위해 **캐시**를 사용하고, 캐시의 크기도 성능에 영향을 미친다.

GPU는 화상처리를 여러 개의 코어로 동시 및 병렬 처리하는 프로세서인데, 딥러닝 등 대량의 고속 연산이 필요한 경우 이용된다.

CPU와 GPU는 고성능일수록 비용이 올라가기 때문에 서버 장비 구축 시 고려해야 할 부분이다.

#### 메모리

CPU가 직접 엑세스할 수 있는 기억장치.

서버용으로는, 전력 소모가 적고 **오류 처리**가 탑재되어 있는 것을 선정하는 편.

마찬가지로 비용을 고려해야 한다.

#### 스토리지

영구적인 데이터를 저장하는 디바이스로, 보조기억장치라고도 함.

용량, 읽기 쓰기 속도가 시스템 전체 응답 시간에 영향을 준다.

하드디스크나 SSD 등을 이용하고, SAN 스토리지 같이 기업 용도로 이용되는 Fiber Channel 하드디크스도 있다.

데이터 손실을 막기 위해 대부분 **다중화** 구성을 취한다.

#### 그 외: 온프레미스 환경

- 전원 트러블에 의한 순간적 차단을 막기 위한 UPS

- 여러 대의 서버를 관리하기 위한 KVM 스위치

- **서버 랙**: 서버 장치 설치에 사용. 메인터넌스에 쉬운 것을 선택하게 된다.

- 데이터센터, 기계실의 하중 설계, 전기 공사, 공조 설비 등

위와 같은 서버 장비들은 시스템 이용 용도에 따라 하드웨어 제조 업체가 다양한 제품을 출시하고 있기 때문에, 기능이나 예산을 고려하여 도입하게 된다.

#### 그 외: 클라우드 환경

- 하드웨어의 선정은 곧 **가상 머신의 사양 선정**으로 대치된다.

- 기존 서비스에 클라우드를 어떻게 조합할 지에 대해서는 전문적 상담을 요한다.

- 컨설팅부터 운용까지 담당해주는 클라우드 시스템 인테그레이터도 있다.

### 네트워크 주소

네트워크에서는 서버나 클라이언트, 각종 네트워크 장비를 식별하기 위해 **네트워크 주소**를 사용한다.

#### MAC 주소(물리 주소/이더넷 주소)

네트워크 인터페이스 카드, 무선 LAN 칩 등 네트워크 부품에 **물리적으로 할당되는 48비트 주소**다.

- 앞 24비트는 부품 제조업체 식별번호.

- 16진수로 표기하고, 앞에서 2바이트씩 구분된다.

- OSI 모델 중 2계층인, **데이터 링크 계층**에서 사용한다.

#### IP 주소

인터넷이나 인트라넷 같이 **네트워크에 연결된** 컴퓨터나 네트워크 장비에 할당되는 식별 번호.

- IPv4의 경우 8비트씩 4개로 구분된 32비트 주소인데, 하나의 네트워크에 2^32대까지만 연결이 가능해서 IP 주소 고갈이 우려되는 사황.

- 따라서 최근 프라이빗 IP와 퍼블릭 IP를 구분하여, 
  
  - 업무에 사용되는 내부 네트워크에서는 임의의 주소를 할당하는 프라이빗 주소를
  
  - 외부 인터넷과의 경계에서는 **NAT**이라는 장비를 통해 변환된 퍼블릭 주소를 사용하는 방식을 흔히 사용한다.
  
  - IPv6에서는 아예 128비트짜리 주소를 할당한다.

### OSI 참조 모델과 통신 프로토콜

통신을 서로 이해하기 위해서는 적절한 **약속**이 필요하다.

**통신 프로토콜**이, 서로 어떤 약속으로 통신을 할지 정한 규약에 해당한다.

시스템은 웹, 메일 송수신, 파일 전송, Secure Shell 등 통신을 사용하는데, 각각의 프로토콜이 정해져 있다.

OSI 참조 모델은, **컴퓨터의 통신 기능을 계층 구조로 나눈** 개념 모델이다.

#### 응용 계층 (레이어 7)

웹의 HTTP나 메일 전송을 하는 SMTP 같은, **어플리케이션에 특화된** 프로토콜을 규정한다.

#### 표현 계층 (레이어 6)

데이터의 저장 형식이나 압축, 문자 인코딩 같은 **데이터의 표현 형식**을 규정한다.

#### 세션 계층 (레이어 5)

커넥션 확립 타이밍이나 데이터 전송 타이밍을 규정한다.

어플리케이션 간 request와 response로 구성된다.

#### 전송 계층 (레이어 4)

데이터 전송을 제어하는 계층이다. 전송 오류를 검출하고, 재전송을 규정한다.

대표적인 프로토콜은 **TCP**와 **UTP**.

- 이 정도 선에서 데이터가 통신 상대의 노드로 확실하게 보내진다.

#### 네트워크 계층 (레이어 3)

**서로 다른 네트워크 간**에 통신을 하기 위한 규정이다.

서로 다른 네트워크에 데이터 패킷을 전송하는 것을 **라우팅**이라 한다.

IP주소를 바탕으로 네트워크 계층에서 작동하는 통신 장비로는 **라우터**와 **L3 스위치**가 있고, 이러한 장비들은 패킷을 어디로 전송할지 정보를 담는 **라우팅 테이블**을 관리하고 있다.

#### 데이터 링크 계층 (레이어 2)

**동일한 네트워크 안**에 있는 노드 간 통신을 규정한다.

MAC 주소로 데이터를 전송하고, 주요 네트워크 장비로는 **L2 스위치**가 있다.

- L2 스위치는 통신할 노드가 어떤 포트에 연결되어 있는지 MAC 주소를 사용해 판단하고 패킷을 전송한다.

#### 물리 계층 (레이어 1)

통신 장비의 물리적 및 전기적 특성을 규정한다.

데이터를 어떻게 전기적으로 할당할 것인지, 케이블이나 커넥터의 모양 등.

### 방화벽

시스템 가동 시 **보안**은 매우 중요한 파트이다.

그리고 보안에 가장 효과적인 방법 중 하나가, **외부와의 불필요한 통신을 차단하는 것**이다.

- 방화벽은 내부와 외부 네트워크 간 통신을 제어하여 내부 네트워크의 안전을 유지하기 위한 기술이다.

#### 패킷 필터형

통과하는 패킷을 포트번호, IP 주소를 바탕으로 필터링하는 방법.

패킷 필터링의 룰을 **ACL**(엑세스 제어 리스트)라고 한다.

#### 어플리케이션 게이트웨이형

어플리케이션 프로토콜 레벨에서 외부와의 통신을 대체 제어하는 방식

일반적으로 **프록시 서버**라고 부른다.

### 라우터/L3 스위치

**라우터**는, 2개 이상의 서로 다른 네트워크 간을 중계하기 위한 통신 장비.

- OSI 3계층인 **네트워크 계층에서 작동**

- 어떤 루트로 데이터를 전송할지 판단하기 위해 **경로 선택 기능**을 가짐.
  
  - 경유 대상이 되는 루트에는 **라우팅 테이블** 바탕으로 정해지는 **정적 경로**와 라우팅 프로토콜에서 설정되는 **동적 경로**가 있다.

**L3 스위치**는 라우터와 거의 같은 기능을 가지지만, **라우팅을 하드웨어로 처리**하고 있어서 보다 빠르다는 특징이 있다.

- 연결할 수 있는 **이더넷 포트** 수가 많다.

---

## OS(Linux) 기초 지식

하드웨어나 네트워크를 제어하는 것이 OS의 역할.

Docker는 Linux의 기능을 적극 사용하는 기술이다.

### Linux




