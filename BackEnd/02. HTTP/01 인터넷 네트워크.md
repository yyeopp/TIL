# 인터넷 네트워크

---

## 인터넷 통신

클라이언트와 서버 간의 통신은 인터넷 구간을 거쳐서 이루어진다.

수많은 경로와 노드가 있는데, 어떻게 그걸 가능하게 하는지

---

## IP (인터넷 프로토콜)

클라이언트와 서버에 각기 IP 주소를 부여하고 시작한다.

IP (프로토콜)의 역할은,

- 지정한 **IP 주소**로 데이터를 전달하고

- 데이터를 **패킷**이라는 통신 단위로 전달하는 것

### IP 패킷 정보

- 출발지 IP

- 목적지 IP

- 그 외

- 전송 데이터

클라이언트와 서버 사이 모든 노드들은 IP 프로토콜을 준수한다.

패킷에 적혀있는 정보를 바탕으로 서버까지 전달하고, 돌아옴

### IP 프로토콜의 한계

#### 비연결성

패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷이 전송되고, 클라이언트는 그걸 모른다.

#### 비신뢰성

중간에 패킷 유실

- 인터넷 구간 내 노드 중에 하나가 고장나 있을 수도 있는 것

패킷 간 순서 문제

- 클라이언트가 전달하는 원본 패킷 용량이 크면 IP 프로토콜 상 잘라서 보내게 된다.

- 도착하는 순서는 충분히 달라질 수 있다.

#### 프로그램 구분

같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 여러 개일 때, 어떤 애플리케이션과 통신해야 하는지

---

## TCP, UDP

### 인터넷 프로토콜 스택의 4계층

- 애플리케이션 계층 - HTTP, FTP
  
  - 프로그램이 전달하고자 하는 메시지를 생성하고,
  
  - **SOCKET 라이브러리**를 통해 하위 계층 (전송)으로 전달

- 전송 계층 - TCP, UDP
  
  - **OS 레벨**에서 메시지 데이터를 묶어서 **TCP 정보**를 생성한다.

- 인터넷 계층 - IP
  
  - 여기도 **OS 레벨**. TCP 데이터를 묶어서 **IP 패킷**을 생성하고 하위 계층으로 전달

- 네트워크 인터페이스 계층
  
  - LAN 카드, LAN 드라이버에 해당
  
  - 이더넷 프로토콜을 통해 인터넷 구간으로 전송

### TCP/IP 패킷 정보

위에 나왔던 IP 패킷 **안쪽**에,

- 출발지 **PORT**

- 목적지 PORT

- **전송 제어**

- **순서**

- **검증 정보**

이게 포함된다.

### TCP 특징

**전송 제어 프로토콜**

- 연결지향 - **TCP 3 way handshake**

- 데이터 전달 보증

- 순서 보장

**신뢰**할 수 있는 프로토콜에 해당한다.

현재 대부분의 웹 애플리케이션에서 사용한다.

### TCP 3 way handshake

1. 클라이언트 SYN (접속 요청)

2. 서버 SYN+ACK (요청 수락 + 접속 요청)

3. 클라이언트 ACK (요청 수락)
   
   - 해당 ACK와 함께 데이터 전송도 가능함

이렇게 해서 **연결을 확정**했다고 흔히 말은 하지만,

어디까지나 **가상의** **개념적, 논리적인** 연결이지 물리적 수준의 연결이 아님을 주의

### 데이터 전달 보증

데이터가 전달됐으면, 전달 됐다는 응답을 받도록 되어있는 구조

### 순서보장

데이터가 전달됐을 때, 순서 checksum을 검증하는 구조

순서가 잘못 들어오면 그 이후의 패킷을 버리고 다시 달라고 요청하는 절차가 포함됨

### UDP 특징

**사용자 데이터그램 프로토콜**

- 사실상 기능이 아예 없음 (하얀 도화지)

- 연결지향X, 데이터 전달 보증X, 순서 보장 X

- **단순하고 빠름**

사실상 그냥 **IP랑 같은데,** **PORT랑 체크섬**만 추가된 정도

- PORT는 하나의 IP에서 여러 개의 애플리케이션을 구분하는 용도로 사용되기 때문에 반드시 필요한 것

내가 뭔가 통신 프로토콜을 최적화하고 싶다?

- TCP는 건들 수가 없다. 건들면 큰일남

- 대신 UDP는 맘대로 써도 된다. 그 위에 구현되어 있는 게 딱히 없기 때문

---

## PORT

하나의 클라이언트 / 서버에서 **여러 개의 애플리케이션**을 이용해 통신할 때 필요한 정보

- IP는 서버, PORT는 애플리케이션을 식별하는 정보

- **TCP/IP 패킷은 IP와 PORT를 들고 있다**는 걸 기본 전제로 알면 된다.

0~**65535** 를 할당할 수 있다.

- **1023**번까지는 well-known port로, 사용하지 않는 것이 좋다.

---

## DNS

### IP만 사용할 수 있을까?

사용자가 기억하기 어렵다.

서버 IP는 언제든지 변경될 수도 있다.

### DNS - 도메인 네임 시스템

일종의 IP 전화번호부

**도메인 명을 IP 주소로 변환해주는 시스템**

- 사용자가 도메인 명으로 접근을 시도하면,

- 별도의 DNS 서버가 IP 주소를 리턴해준다.


