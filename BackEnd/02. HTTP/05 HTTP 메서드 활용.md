# HTTP 메서드 활용

---

## 클라이언트에서 서버로 데이터 전송

### 데이터 전달 방식

#### 쿼리 파라미터

**GET**

주로 정렬 필터, 검색어에 활용

#### 메시지 바디

**POST, PUT, PATCH**

회원가입, 상품 주문, 리소스 등록, 변경 등

### 4가지 케이스

- 정적 데이터 조회
  
  - 이미지, 정적 텍스트

- 동적 데이터 조회
  
  - 검색, 정렬 등

- HTML Form을 통한 데이터 전송
  
  - 회원가입, 상품 주문 등 데이터 변경

- HTTP API를 통한 데이터 전송
  
  - 회원가입, 상품 주문 등 데이터 변경
  
  - 서버 to 서버, 앱 클라이언트, 웹 클라이언트(Ajax)

### 정적 데이터 조회

이미지, 정적 텍스트 문서

**GET**으로 조회

일반적으로 **쿼리 파라미터 없이 리소스 경로로** 단순 조회

### 동적 데이터 조회

검색, 정렬 등

**GET**으로 조회하되, **쿼리 파라미터를 사용**해서 데이터 전

### HTML Form 데이터 전송

HTML의 form 태그를 이용한 데이터 전송 방식

- GET, POST 만 지원

- 기본적으로 POST 사용
  
  - GET 사용 시 url에 쿼리 파라미터로 입력됨

#### application/x-www-form-urlencoded

브라우저가 일반적으로 사용하는, HTTP 헤더의 **Content-Type** 값.

form 내용을 메시지 바디로 전송한다.

key=value의 **쿼리 파라미터** 형식 사용

- 전송 데이터는 url encoding 처리된다.

#### multipart/form-data

브라우저가 **파일 업로그** 같은 **바이너리 데이터**를 전송해야할 때 사용하는 **Content-Type**

자체적으로 설정된 **구분자**를 사용해, 서로 다른 종류의 데이터를 메시지 바디에 넣어서 전송한다.

- 일반적인 String 값과 jpeg 파일을 같이 넘길 수 있음

### HTTP API 데이터 전송

서버 to 서버나 앱/웹 클라이언트 방식에서 사용.

**Content-Type: application/json**를 주로 사용 (사실상 표준)

- POST, PUT, PATCH 인 경우 메시지 바디에 JSON 형식으로 넣어서 데이터 전송
  
  - JSON 말고 TEXT, XML도 사용 가능
  
  - XML은 구 표준

- GET은 쿼리 파라미터로 데이터 전송

---

## HTTP API 설계

### URI 설계 개념

#### 문서 (document)

단일 개념

- 파일 하나, 객체 인스턴스, 데이터베이스 row

- `/members/100`

#### 컬렉션 (collection)

**서버가 관리하는 리소스 디렉터리**

서버가 리소스의 **URI를 생성하고 관리**

- `/members`

대부분 컬렉션을 사용하게 됨

#### 스토어 (store)

**클라이언트가 관리하는 자원 저장소**

클라이언트가 리소스의 **URI를 알고 관리**

- `/files`

클라이언트가 파일을 직접 갖다가 꽂는 정도일 때 사용

- 빈도 낮은 편

#### 컨트롤러(controller), 컨트롤 URI

문서, 컬렉션, 스토어 내에서 해결이 안 되는, 복잡한 **프로세스**를 실행시키기 위한 개념

**동사를 직접 사용**

- `/members/id/delete`

### 정리

기본 설계는 문서, 컬렉션, 스토어 내에서 해결한다.

그걸로 안 될 때만 컨트롤 URI를 사용한다.

### 신규 자원 등록 시의 컬렉션과 스토어

#### POST - 컬렉션

클라이언트는 등록될 리소스의 **URI를 모른다**.

- `POST /members`

서버가 새로 등록된 리소스의 URI를 생성하고, 관리

**컬렉션**(Collection) 개념 적용

- **서버가 관리하는 리소스 디렉토리**

#### PUT - 스토어

클라이언트가 리소스의 **URI를 알고 있다.**

- `PUT /files/star.jpg`

- 직접 리소스 URI를 지정해서 밀어넣는 방식

**스토어**(Store) 개념 적용

- **클라이언트가 관리하는 리소스 저장소**

#### 소결

실제 대부분의 서비스에서는 POST를 사용하는 게 자연스럽다.

PUT을 사용하는 건 웹하드 정도 생각하면 됨.

둘을 구분할 줄 아는 게 중요하다.

### HTML FORM 사용

HTML FORM은 **GET, POST** 둘만 지원하기 때문에, **컨트롤 URI** 사용이 불가피한 경우가 많다.

- 등록과 수정, 삭제를 URI 내에 **동사**로 써넣는 식.

- `/new /edit /delete` 등 직접 사용




