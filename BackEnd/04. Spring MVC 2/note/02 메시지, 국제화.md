# 메시지, 국제화

---

## 소개

### 메시지

화면 상 나타나는 메시지가 **하드코딩** 되어있는 경우 유지보수할 때 문제가 크다.

화면 소스 (HTML) 에서는 특정 메시지를 지칭하는 **key** 값만 코딩하고, 실제 메시지(value)는 별도의 파일로 관리하는 방법이 보다 합리적이다.

### 국제화

메시지를 key-value 로 관리하는 정도에서 더 나아가서, 메시지를 **다국어화**하는 것까지 생각해볼 수 있다.

어차피 **HTTP 헤더에서 locale 정보**를 담고 있기 때문에, 클라이언트 정보에 따라 필요로 하는 언어를 로딩하는 것이 불가하지 않은 것.

스프링은 위와 같은 기본적인 **메시지와 국제화** 기능을 제공해주고 있다.

---

## 스프링 메시지 소스 설정

스프링이 제공하는 `MessageSource` 라는 스프링 빈을 사용하여 메시지, 국제화 처리가 가능하다.

- 구현체로는 `ResourceBundleMessageSource` 를 사용하는 게 일반적
  
  - 특정 디렉토리에 있는 `message.properties` 를 가져와서 key-value로 이루어진 메시지 정보를 매핑해주는 처리를 담당한다.
  
  - 보통 `/resources` 하위에서 관리한다.

- 스프링부트는 어차피 자동으로 등록해준다. 직접 등록할 필요가 없다.
  
  - `message` 라는 이름으로 자동 등록되며,
  
  - `basename` 값 properties 파일에서 수정할 수 있다.

---

## 스프링 메시지 소스 사용

`MessageSource` 인터페이스의 `getMessage()` 메서드를 사용하면, `message.properties` 파일로 관리 중인 메시지 소스를 편리하게 가져다 쓸 수 있다.

- 메서드 오버로딩이 여러 개 되어있어서, Locale 정보나 Default 메시지 지정, 파라미터 넘기 등 편의 기능을 제공 가능하다.

- 타임리프를 함께 사용한다면, 타임리프 태그를 사용해서 HTML 수준에서 편하게 메시지 처리할 수 있다.

---

## 스프링의 국제화 메시지 선택

기본적으로 스프링은 HTTP 헤더의 `Accept-Language` 를 기반으로 메시지 국제화 처리를 진행한다.

하지만 Locale 값은 실제 웹 브라우저 사용자가 직접 바꾸는 일이 적기 때문에, 보다 사용자가 편리하게 Locale 값을 변경하고 그에 맞춰 국제화 처리가 가능하도록 지원해줄 필요가 있다.

### LocaleResolver

스프링은 `Locale` 선택 방식을 변경할 수 있도록 `LocaleResolver` 인터페이스를 제공한다.

- 기본값이 `AcceptHeaderLocaleResolver` 이기 때문에, 별도의 처리가 없다 HTTP 헤더에 의존할 수 있는 것.

만약 Locale 선택 방식을 **HTTP 헤더가 아닌** **쿠키**나 **세션** 기반으로 변경하고자 한다면, `LocaleResolver`의 구현체만 간편하게 변경하면 된다.


