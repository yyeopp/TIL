# 트랜잭션 이해

---

## 트랜잭션 - 개념 이해

데이터베이스를 굳이 사용하는 이유로 **트랜잭션**을 꼽을 수도 있다.

**트랜잭션**은?

- 데이터베이스에서 **하나의 거래를 안전하게 처리하도록 보장해주는 것**을 뜻한다.

- 하나의 거래는 여러 건의 데이터 변경을 한 세트로 묶고 다니는 경우가 대부분이다.
  
  - 대표적으로 계좌이체

- 이러한 경우에 대해, **모든 작업이 성공하거나, 아예 없었던 일로 처리하거나** 하는 것이 중요하다.

- 이걸 DB에서 트랜잭션으로 관리해준다.
  
  - 정상 반영을 `Commit`
  
  - 작업 중 하나라도 실패한 경우 원복시키는 것을 `Rollback`

### 트랜잭션 ACID

트랜잭션은 **원자성, 일관성, 격리성, 지속성**을 보장해야 한다.

- **원자성**: 트랜잭션 내에서 실행한 작업들은 모두 성공하거나 모두 실패

- **일관성**: 모든 트랜잭션은 일관성 있는 데이터베이스 상태를 유지해야 한다.

- **격리성**: 동시에 실행되는 트랜잭션들이 서로에게 영향을 미치지 않도록 격리해야 한다.
  
  - *원칙적으로* 동시에 같은 데이터를 수정하지 못하도록 한다.
  
  - 다만, 동시성 관련 **성능 이슈**가 발생하므로 **트랜잭션 격리 수준**은 따로 선택하고 관리한다.

- **지속성**: 트랜잭션이 성공적으로 끝나면 그 결과가 항상 기록되어야 한다.

### 트랜잭션 격리 수준 - Isolation level

나머지는 다 괜찮은데, **격리성**을 완전히 보장하려면 트랜잭션을 사실상 **순서대로 하나씩** 실행해야 한다. 그러면 성능이 극히 나빠질 수밖에 없다.

이에 따라 ANSI 표준은 트랜잭션 격리 수준을 4단계로 나누고 있다.

- **READ UNCOMMITED**: 커밋되지 않은 것까지 읽음

- **READ COMMITED**: 커밋된 것까지 읽음
  
  - 대부분 이 정도를 사용한다.

- **REPEATABLE READ**: 반복 가능한 읽기

- **SERIALIZABLE**: 직렬화

---

## 데이터베이스 연결 구조와 DB 세션


